# =============================================================================
# IDS-RS - Fisier de Configurare
# =============================================================================
# Formatul TOML: https://toml.io/
# =============================================================================

[network]
# Adresa IP pe care asculta serverul UDP. "0.0.0.0" = toate interfetele.
listen_address = "0.0.0.0"
# Portul UDP pe care se primesc log-urile de la firewall.
listen_port = 5555
# Tipul de parser activ: "gaia" (Checkpoint Gaia Raw) sau "cef" (ArcSight CEF).
parser = "gaia"
# Mod debug: afiseaza fiecare pachet primit cu validare parsare.
# debug = true
# Rate limiting UDP: protejeaza CPU-ul impotriva flood-ului de pachete.
# udp_rate_limit = pachete acceptate per secunda (0 = dezactivat).
# udp_burst_size = capacitate burst (permite varfuri scurte legitime).
udp_rate_limit = 5000
udp_burst_size = 20000

# -----------------------------------------------------------------------------
# Praguri de detectie pentru scanari de retea
# -----------------------------------------------------------------------------

[detection]
# Perioada de cooldown (secunde) intre alerte repetate pentru acelasi IP.
# Previne spam-ul de alerte cand un atac este deja detectat.
alert_cooldown_secs = 300

# Maxim port-hit-uri tinute in memorie per IP sursa.
# Un scanner de porturi la viteza mare poate genera mii de hit-uri intre doua
# cleanup cycle-uri. Fara aceasta limita, un singur IP rau-intentionat ar putea
# consuma sute de MB de RAM. La 10.000 intrari x ~24 bytes = ~240 KB per IP.
max_hits_per_ip = 10000

# Maxim IP-uri urmarite simultan in memorie.
# Fara aceasta limita, un atacator care spoofs milioane de IP-uri sursa diferite
# ar putea umple RAM-ul serverului. Cand se atinge limita, IP-ul cel mai vechi
# (LRU â€” Least Recently Used) este eliminat pentru a face loc celui nou.
max_tracked_ips = 100000

[detection.fast_scan]
# Numar de porturi unice care declanseaza alerta de Fast Scan.
# Alerta se emite cand un IP acceseaza > port_threshold porturi unice
# in time_window_secs secunde.
port_threshold = 15
time_window_secs = 10

[detection.slow_scan]
# Numar de porturi unice care declanseaza alerta de Slow Scan.
# Alerta se emite cand un IP acceseaza > port_threshold porturi unice
# in time_window_mins minute.
port_threshold = 30
time_window_mins = 5

[detection.accept_scan]
# Numar de porturi unice ACCEPTATE (permise de firewall) care declanseaza
# alerta de Accept Scan. Alerta se emite cand un IP acceseaza > port_threshold
# porturi DESCHISE in time_window_secs secunde.
# Accept Scan detecteaza enumerarea serviciilor active (open port enumeration).
# Pragul este mai mic decat Fast Scan (traficul accept poate fi mai "normal").
port_threshold = 5
time_window_secs = 30

# -----------------------------------------------------------------------------
# Configurare alerte
# -----------------------------------------------------------------------------

[alerting.siem]
# Trimite alerte catre SIEM (ArcSight) prin UDP syslog.
enabled = true
host = "127.0.0.1"
port = 514

[alerting.email]
# Trimite alerte prin email catre echipa IT/Security.
enabled = true
smtp_server = "smtp.example.com"
smtp_port = 25
smtp_tls = false
from = "ids-rs@example.com"
to = ["it-security@example.com"]
username = ""
password = ""
# Footer personalizabil pentru email-urile de alerta.
# Poate contine banner ASCII al echipei, disclaimer, etc.
# Folositi """ pentru text multi-linie in TOML.
email_footer = """
       ____  ____  ____  ____
      / ___|| ___|| __ )|___ \\
      \\___ \\|___ \\|  _ \\  __) |
       ___) |___) | |_) |/ __/
      |____/|____/|____/|_____|

  Generat automat de S5B2"""

# -----------------------------------------------------------------------------
# Mentenanta memorie
# -----------------------------------------------------------------------------

[cleanup]
# Intervalul (secunde) la care ruleaza task-ul de cleanup.
interval_secs = 60
# Varsta maxima (secunde) a inregistrarilor din memorie. Dupa acest interval,
# datele de port-hit pentru un IP sunt sterse, eliberand memoria.
max_entry_age_secs = 600
